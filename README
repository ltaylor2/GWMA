# ----------------------------------
#
#	Golden-Winged Manakin motion analysis
#	Working draft 09/11/17 
#	LU TAYLOR
#	README
#
# ----------------------------------

This program allows for automated motion detection of GWMA on their display logs.
The vision analysis is built using OpenCV for Python.

Program process:
	1. Read-in a single video file.
		NOTE ffmpeg may print "Invalid UE golomb code" warnings
		while frames are being read in. This does not affect
		the program and, while annoying, should be ignored.
	2. Resize input frames, convert to grayscale, and blur.
	3. Determine motion via velocity across a window of three frames.
	4. Threshold and score motion to determine motion periods. Store clips in a 
		temporary video file to be read back in the next step.
		NOTE this file will be named "tmp_clip_storage.AVI" although this filename
		can be changed with the CLIP_STORAGE_FILENAME constant. This file is deleted
		at the END of the program, after information is printed, so if a run is
		canceled early this has to be deleted manually (or else the next run will
		append clips to the end-- TODO fix)
	5. After a prompt, allow the user to survey motion clips, reading back from the 
		storage file and clearing those that do not feature a bird. The program 
		should contain many false positives but (no guarantees) no false negatives.
	6. Output a final list of times (H:MM:SS.SS) at which motin begins.
		NOTE Due to calculations from frames->seconds, motion occuring
		at the end of the video may be marked up to ~10s early than the 
		motion actually occurs in the video. The clips displayed within
		the program will still be accurate.
	7. OPTIONAL: append final list of times to an output file

Running the program:
	This program was built on Ubuntu 16.04 in Python 2.7.12 using OpenCV 3.3.0-dev.
	Other versions may interfere with video I/O due to Codec problems.
	OpenCV is terrible with version differences, so watch out.
	
	1. On a computer with OpenCV and Python2 installed, open a terminal window.
	2. Navigate (cd) to the directory that contains the src/ folder.
	3. Compile and run the program with the commands:
		python src/motionDetection.py [-h][-w] inFile
		
		[inFile] is required, and must be the file path to the input video

		[-w] is optional. Show the thresholded motion images as the program runs. Fun.
		[-o] is optional. Send it a file path to write the final output message to file.
		[-h] is optional, and displays parameter help without running the program.

	EXAMPLES:
	   UNIX (e.g., OSX or Ubuntu) Example:
		python src/motionDetection.py -w Test_Footage/Male_Female_Brits.mp4
	



		
